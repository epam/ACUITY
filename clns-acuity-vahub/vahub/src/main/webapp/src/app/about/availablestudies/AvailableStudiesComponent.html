<!--
  ~ Copyright 2021 The University of Manchester
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->

<div class="main main--grey study-selection-content" id="main" role="main" xmlns="http://www.w3.org/1999/html">
    <study-selection-controls [numberOfSubjects]="totalNumberOfSubjects | async"
                              [submitButtonText]=""
                              (handleUpdateQuery)="handleUpdateQuery($event)"
                              (handleSubmit)="openDataset()"></study-selection-controls>

    <study-list [studyList]="availableDatasets | async"
                [studyWarnings]="studyWarnings | async"
                [searchString]="searchString | async"
                [acls]="acls | async"
                [selectedDatasets]="selectedDatasets | async"
                [isMultipleCollapseAvailable]="true"
                [userActionText]="'This page shows all datasets that are currently loaded in ACUITY'"
                [datasetIdAndNumSubjectsMap]="datasetIdAndNumSubjectsMap | async"
                (handleSelectDataset)="onSelectDataset($event)"></study-list>
</div>

<details-table [details]="counts | async"></details-table>

<progress-messages [loading]="loading | async"></progress-messages>

<app-modal-message [Title]="datasetsInfoModal.title"
                   [Msg]="datasetsInfoModal.body"
                   [ButtonText]="datasetsInfoModal.buttonText"
                   [ModalBeDismissed]="false"
                   [ModalIsVisible]="datasetsInfoModal.isVisible"
                   (modalHasBeenSubmitted)="dismissDatasetInfoModal()">
</app-modal-message>

<app-modal-message [Title]="requestAccessModal.title"
                   [Msg]="requestAccessModal.body"
                   [ButtonText]="requestAccessModal.buttonText"
                   [ModalBeDismissed]="false"
                   [ModalIsVisible]="requestAccessModal.isVisible"
                   (modalHasBeenSubmitted)="dismissRequestAccessModal()">
</app-modal-message>
