<!--
  ~ Copyright 2021 The University of Manchester
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->

<div class="analytics">
    <accordion close-others="true">

        <accordion-group ng-class="{'panel-default': vis.id !== PARENT_MODEL.selectedAcl.datasetId,
                  'panel-primary': vis.id === PARENT_MODEL.selectedAcl.datasetId}"
                         ng-repeat="vis in PARENT_MODEL.allAcls.datasets | filterOr:PARENT_MODEL.searchTerm ">

            <div ng-controller="MyAnalyticsDatasetAclController">
                <accordion-heading>
                    <span ng-click="loadDataset()">{{vis | cleanDatasetAndAppendType}}</span>
                    &nbsp;
                    <small ng-click="loadDataset()">{{vis.drugProgramme}}</small>
                    <span ng-show="vis.lockdown" style="color: black" alt="In lockdown" class="glyphicon glyphicon-lock"></span>
                    <i class="pull-right glyphicon" ng-click="MODEL.pageType = 'info'; loadDataset();
                        $event.stopPropagation();" ng-class="{'glyphicon-chevron-left': MODEL.pageType !== 'info'}"></i>

                </accordion-heading>

                <div class="animate-switch-container" ng-switch="MODEL.pageType">
                    <div class="animate-switch" ng-switch-when="edit">
                        <div ng-include="'views/myAnalytics/datasetEditUsers.html'"></div>
                    </div>
                    <div class="animate-switch" ng-switch-when="info">
                        <div ng-include="'views/myAnalytics/datasetShowInfo.html'"></div>
                    </div>
                    <div class="animate-switch" ng-switch-when="edit_views">
                        <div ng-include="'views/myAnalytics/editUsersViews.html'"></div>
                    </div>
                </div>
            </div>

        </accordion-group>
    </accordion>

</div>
